---
layout: default
---

{% if page.image %}
<link rel="preload" as="image" href="{{ page.image }}" />
{% endif %}

<!-- 플로팅 목차 버튼 -->
<button class="toc-toggle" id="tocToggle" aria-label="목차 열기">
  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <line x1="3" y1="6" x2="21" y2="6"></line>
    <line x1="3" y1="12" x2="15" y2="12"></line>
    <line x1="3" y1="18" x2="18" y2="18"></line>
  </svg>
</button>

<!-- 목차 팝업 -->
<div class="toc-popup" id="tocPanel">
  <div class="toc-popup-header">
    <span>목차</span>
    <button class="toc-close" id="tocClose" aria-label="목차 닫기">✕</button>
  </div>
  <nav class="toc-nav" id="tocNav"></nav>
</div>

<div class="container">
  <div class="post-header">
    <div class="post-meta">
      <span class="post-date">{{ page.date | date: "%Y. %m. %d" }}</span>
      {% if page.tags %}
        {% for tag in page.tags %}
          <span class="post-tag">{{ tag }}</span>
        {% endfor %}
      {% endif %}
    </div>
    <h1>{{ page.title }}</h1>
  </div>

  <article class="post-content">
    {{ content }}
    <a href="{{ '/' | relative_url }}" class="back-link">← 목록으로 돌아가기</a>
  </article>

  <!-- 이전글 / 다음글 -->
  <nav class="post-nav">
    {% if page.previous.url %}
    <a href="{{ page.previous.url | relative_url }}" class="post-nav-item post-nav-prev">
      <span class="post-nav-label">← 이전 글</span>
      <span class="post-nav-title">{{ page.previous.title }}</span>
    </a>
    {% else %}
    <div class="post-nav-item post-nav-empty"></div>
    {% endif %}

    {% if page.next.url %}
    <a href="{{ page.next.url | relative_url }}" class="post-nav-item post-nav-next">
      <span class="post-nav-label">다음 글 →</span>
      <span class="post-nav-title">{{ page.next.title }}</span>
    </a>
    {% else %}
    <div class="post-nav-item post-nav-empty"></div>
    {% endif %}
  </nav>

  <!-- 소셜 공유 버튼 -->
  <div class="share-buttons">
    <span class="share-label">공유하기</span>
    <button class="share-btn kakao" onclick="shareKakao()" aria-label="카카오톡 공유">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 3C6.5 3 2 6.6 2 11c0 2.8 1.9 5.3 4.7 6.7-.2.8-.6 2.7-.7 3.1 0 .2.1.4.3.4.1 0 .3-.1.4-.2.6-.4 3.3-2.1 4.3-2.7.3 0 .7.1 1 .1 5.5 0 10-3.6 10-8S17.5 3 12 3z"/>
      </svg>
    </button>
    <button class="share-btn twitter" onclick="shareTwitter()" aria-label="X(트위터) 공유">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
      </svg>
    </button>
    <button class="share-btn facebook" onclick="shareFacebook()" aria-label="페이스북 공유">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
      </svg>
    </button>
    <button class="share-btn copy" onclick="copyURL()" aria-label="URL 복사" id="copyBtn">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </button>
    <button class="share-btn native" onclick="shareNative()" aria-label="공유" id="nativeShareBtn" style="display:none;">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="18" cy="5" r="3"></circle>
        <circle cx="6" cy="12" r="3"></circle>
        <circle cx="18" cy="19" r="3"></circle>
        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
      </svg>
    </button>
  </div>

  <!-- 관련글 -->
  {% assign related_posts = site.posts | where: "category", page.category | where_exp: "post", "post.url != page.url" | limit: 4 %}
  {% if related_posts.size > 0 %}
  <div class="related-posts">
    <h2>관련 글</h2>
    <div class="related-grid">
      {% for post in related_posts %}
      {% if post.naver_url %}
      <a href="{{ post.naver_url }}" target="_blank" class="related-card">
      {% else %}
      <a href="{{ post.url | relative_url }}" class="related-card">
      {% endif %}
        <div class="related-card-meta">{{ post.date | date: "%Y. %m. %d" }}</div>
        <div class="related-card-title">{{ post.title }}</div>
      </a>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <!-- Disqus 댓글 -->
  <div class="comments">
    <div id="disqus_thread"></div>
    <script>
    var disqus_config = function () {
      this.page.url = "{{ page.url | absolute_url }}";
      this.page.identifier = "{{ page.id }}";
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://brothrone-travel.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</div>

<style>
.post-nav {
  display: flex;
  gap: 12px;
  max-width: 720px;
  margin: 0 auto 32px;
  padding: 32px 40px 0;
  border-top: 1px solid var(--border);
}
.post-nav-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 16px 20px;
  border: 1px solid var(--border);
  border-radius: 12px;
  text-decoration: none;
  color: var(--text);
  transition: background 0.2s, border-color 0.2s;
  min-width: 0;
}
.post-nav-item:hover { background: var(--surface); border-color: var(--text-muted); }
.post-nav-empty { border: none; background: none !important; }
.post-nav-next { text-align: right; }
.post-nav-label { font-size: 0.75rem; color: var(--text-muted); letter-spacing: 0.05em; }
.post-nav-title { font-size: 0.9rem; font-weight: 500; line-height: 1.4; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }

.toc-toggle {
  position: fixed;
  bottom: 96px;
  right: 40px;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: var(--text);
  color: var(--bg);
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  z-index: 900;
  transition: transform 0.2s;
}
.toc-toggle:hover { transform: scale(1.1); }

/* 말풍선 팝업 */
.toc-popup {
  position: fixed;
  bottom: 152px;
  right: 40px;
  width: 320px;
  max-height: 400px;
  background: var(--bg);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.15);
  z-index: 1000;
  display: flex;
  flex-direction: column;
  opacity: 0;
  visibility: hidden;
  transform: translateY(8px) scale(0.97);
  transform-origin: bottom right;
  transition: opacity 0.2s ease, transform 0.2s ease, visibility 0.2s;
}
/* 말풍선 꼬리 */
.toc-popup::after {
  content: '';
  position: absolute;
  bottom: -8px;
  right: 14px;
  width: 14px;
  height: 14px;
  background: var(--bg);
  border-right: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
  transform: rotate(45deg);
}
.toc-popup.open {
  opacity: 1;
  visibility: visible;
  transform: translateY(0) scale(1);
}
.toc-popup-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px 12px;
  border-bottom: 1px solid var(--border);
  font-size: 0.78rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-muted);
  flex-shrink: 0;
}
.toc-close {
  background: none;
  border: none;
  cursor: pointer;
  color: var(--text-muted);
  font-size: 1rem;
  padding: 2px 4px;
  line-height: 1;
  transition: color 0.2s;
}
.toc-close:hover { color: var(--text); }
.toc-nav {
  overflow-y: auto;
  padding: 10px 0;
  flex: 1;
}
.toc-nav a {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 5px 16px;
  font-size: 0.82rem;
  color: var(--text-muted);
  text-decoration: none;
  line-height: 1.5;
  transition: color 0.15s, background 0.15s;
  word-break: keep-all;
  word-wrap: break-word;
}
.toc-nav a::before {
  content: '•';
  font-size: 0.6rem;
  flex-shrink: 0;
  opacity: 0.5;
  transition: opacity 0.15s;
}
.toc-nav a:hover {
  color: var(--text);
  background: var(--surface);
}
.toc-nav a:hover::before { opacity: 1; }
.toc-nav a.active {
  color: var(--text);
  font-weight: 500;
}
.toc-nav a.active::before {
  opacity: 1;
  color: var(--text);
}
.toc-nav a.toc-h3 {
  padding-left: 32px;
  font-size: 0.77rem;
}
.toc-nav a.toc-h3::before { content: '–'; }

@media (max-width: 600px) {
  .post-nav { flex-direction: column; padding: 24px 20px 0; }
  .post-nav-next { text-align: left; }
  .toc-toggle { bottom: 76px; right: 20px; width: 40px; height: 40px; }
  .toc-popup { right: 20px; bottom: 128px; width: calc(100vw - 40px); }
}
</style>

<script>
  const pageUrl = {{ page.url | absolute_url | jsonify }};
  const pageTitle = {{ page.title | jsonify }};
  const pageImage = {{ page.image | absolute_url | jsonify }};
  const pageDescription = {{ page.excerpt | strip_html | truncate: 100 | jsonify }};

  document.addEventListener('DOMContentLoaded', function() {
    const headings = document.querySelectorAll('.post-content h2, .post-content h3');
    const tocNav = document.getElementById('tocNav');
    const tocToggle = document.getElementById('tocToggle');
    if (headings.length === 0) { tocToggle.style.display = 'none'; return; }
    headings.forEach((h, i) => {
      if (!h.id) h.id = 'heading-' + i;
      const a = document.createElement('a');
      a.href = '#' + h.id;
      a.textContent = h.textContent;
      if (h.tagName === 'H3') a.classList.add('toc-h3');
      a.addEventListener('click', closeToc);
      tocNav.appendChild(a);
    });
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const link = tocNav.querySelector(`a[href="#${entry.target.id}"]`);
        if (link) link.classList.toggle('active', entry.isIntersecting);
      });
    }, { rootMargin: '-20% 0px -70% 0px' });
    headings.forEach(h => observer.observe(h));
  });

  function openToc() {
    document.getElementById('tocPanel').classList.add('open');
  }
  function closeToc() {
    document.getElementById('tocPanel').classList.remove('open');
  }
  function toggleToc(e) {
    e.stopPropagation();
    document.getElementById('tocPanel').classList.toggle('open');
  }
  document.getElementById('tocToggle').addEventListener('click', toggleToc);
  document.getElementById('tocClose').addEventListener('click', function(e) {
    e.stopPropagation();
    closeToc();
  });
  document.addEventListener('click', function(e) {
    const panel = document.getElementById('tocPanel');
    if (panel.classList.contains('open') && !panel.contains(e.target)) {
      closeToc();
    }
  });

  function initKakao() {
    if (window.Kakao && !window.Kakao.isInitialized()) Kakao.init('633bea9d67448561d14b00f31281c957');
  }
  function shareKakao() {
    if (!window.Kakao || !window.Kakao.isInitialized()) { copyURL(); return; }
    Kakao.Share.sendDefault({
      objectType: 'feed',
      content: { title: pageTitle, description: pageDescription, imageUrl: pageImage, link: { mobileWebUrl: pageUrl, webUrl: pageUrl } },
      buttons: [{ title: '글 보기', link: { mobileWebUrl: pageUrl, webUrl: pageUrl } }],
    });
  }
  function shareTwitter() { window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(pageTitle) + '&url=' + encodeURIComponent(pageUrl), '_blank', 'width=550,height=450,noopener,noreferrer'); }
  function shareFacebook() { window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(pageUrl), '_blank', 'width=550,height=450,noopener,noreferrer'); }
  function copyURL() {
    const btn = document.getElementById('copyBtn');
    if (navigator.clipboard && window.isSecureContext) {
      navigator.clipboard.writeText(pageUrl).then(() => showCopied(btn)).catch(() => fallbackCopy(btn));
    } else fallbackCopy(btn);
  }
  function fallbackCopy(btn) {
    const t = document.createElement('textarea');
    t.value = pageUrl; t.style.cssText = 'position:fixed;opacity:0;';
    document.body.appendChild(t); t.select();
    try { document.execCommand('copy'); showCopied(btn); } catch(e) { alert('URL: ' + pageUrl); }
    document.body.removeChild(t);
  }
  function showCopied(btn) {
    btn.classList.add('copied');
    btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>';
    setTimeout(() => {
      btn.classList.remove('copied');
      btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>';
    }, 2000);
  }
  function shareNative() { if (navigator.share) navigator.share({ title: pageTitle, text: pageDescription, url: pageUrl }); }
  if (navigator.share) document.getElementById('nativeShareBtn').style.display = 'flex';
  (function() {
    var s = document.createElement('script');
    s.src = 'https://developers.kakao.com/sdk/js/kakao.min.js';
    s.defer = true; s.onload = initKakao;
    document.head.appendChild(s);
  })();
</script>

<script defer>
  document.querySelectorAll('.post-content img').forEach(img => {
    if (!img.hasAttribute('loading')) img.setAttribute('loading', 'lazy');
    const src = img.getAttribute('src');
    if (src && src.match(/\.(jpg|jpeg|png)$/i)) {
      const webpSrc = src.replace(/\.(jpg|jpeg|png)$/i, '.webp');
      const t = new Image();
      t.onload = function() { img.src = webpSrc; };
      t.src = webpSrc;
    }
  });
</script>
